<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>设置</title>
    <style>
      :root{
        --bg:#0a0a0a; --card:#0d1117; --text:#e6edf3; --muted:#7d8590; --border:#1f2328; --primary:#1f6feb; --primary-hover:#1158c7;
      }
      *{ box-sizing: border-box; }
      html,body{ height:100%; }
      body { margin:0; background: var(--bg); color: var(--text); font: 14px/1.5 -apple-system,BlinkMacSystemFont,"Segoe UI","Noto Sans",Helvetica,Arial,sans-serif,"PingFang SC","Microsoft YaHei"; }
      .page{ max-width: 920px; margin: 0 auto; padding: 32px 24px 48px; }
      .brand{ display:flex; align-items:center; justify-content:center; flex-direction:column; margin-bottom: 28px; text-align:center; }
      .brand-logo{ width: 80px; height: 80px; margin-bottom: 16px; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.3); }
      .brand-title{ font-size: 24px; font-weight: 700; letter-spacing:0.02em; color: var(--text); }
      .brand-sub{ color: var(--muted); font-size: 14px; margin-top:6px; }
      
      /* Tabs */
      .tabs{ display:flex; gap:10px; margin-bottom:20px; border-bottom:1px solid var(--border); }
      .tab{ padding:12px 20px; cursor:pointer; border:none; background:transparent; color:var(--muted); font-weight:600; border-bottom:2px solid transparent; margin-bottom:-1px; transition:all .2s ease; font-size:14px; }
      .tab:hover{ color:var(--text); background:rgba(88,166,255,0.05); }
      .tab.active{ color:var(--primary); border-bottom-color:var(--primary); }
      .tab-content{ display:none; }
      .tab-content.active{ display:block; }
      
      .card{ background: var(--card); border:1px solid var(--border); border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.3); overflow: hidden; margin-bottom:24px; }
      .card-hd{ padding: 16px 20px; border-bottom:1px solid var(--border); background: #0d1117; }
      .card-tt{ font-size: 15px; font-weight: 700; letter-spacing:.02em; color:#e6edf3; }
      .card-bd{ padding: 20px; }
      .grid{ display: grid; grid-template-columns: 1fr; gap: 16px 20px; }
      @media (min-width: 760px){ .grid{ grid-template-columns: 1fr 1fr; } }
      .col-2{ grid-column: span 2; }
      .field label{ display:block; font-weight: 600; margin-bottom:8px; font-size:13px; color: var(--text); }
      .desc{ color: var(--muted); font-size:12px; margin-top:6px; }
      input[type="text"], input[type="number"], textarea{
        width:100%; padding:10px 14px; border:1px solid var(--border); border-radius: 8px; background: #010409; color:var(--text); outline:none; transition: border-color .2s ease, box-shadow .2s ease; font-size:13px;
      }
      input[type="text"]:focus, input[type="number"]:focus, textarea:focus{ border-color: var(--primary); box-shadow: 0 0 0 3px rgba(31,111,235,.15); background:#0d1117; }
      textarea{ min-height: 120px; font-family: 'JetBrains Mono','Fira Code',ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; line-height:1.6; }
      .inline{ display:flex; align-items:center; gap:10px; }
      .actions{ padding: 16px 20px; display:flex; align-items:center; gap:12px; border-top:1px solid var(--border); background: #0d1117; }
      button{ appearance:none; border:1px solid var(--border); border-radius: 8px; padding:10px 16px; cursor:pointer; font-weight:600; font-size:13px; background:#161b22; color: var(--text); transition: all .2s ease; }
      button:hover{ background:#1f2328; border-color:var(--primary); transform: translateY(-1px); box-shadow:0 4px 8px rgba(0,0,0,0.3); }
      button:active{ transform: translateY(0); }
      .primary{ background:transparent; color:#e6edf3; border-color:#e6edf3; }
      .primary:hover{ background:#1f2328; border-color:#e6edf3; box-shadow:0 4px 12px rgba(230,237,243,0.2); }
      .hint{ color: var(--muted); font-size: 12px; }
      .ok{ color: #2ea043; font-weight:600; }
      .err{ color: #f85149; font-weight:600; }
      
      /* Debug Terminal Styles - Dark & Modern */
      .terminal-container{ background:#0a0a0a; color:#e6edf3; border-radius:8px; overflow:hidden; font-family:'JetBrains Mono','Fira Code','Consolas','Monaco',monospace; border:1px solid #1f2328; box-shadow:0 8px 24px rgba(0,0,0,0.4); }
      .terminal-header{ background:#0d1117; border-bottom:1px solid #1f2328; padding:12px 20px; display:flex; align-items:center; justify-content:space-between; }
      .terminal-title{ font-size:13px; font-weight:600; letter-spacing:0.5px; color:#7d8590; display:flex; align-items:center; gap:8px; }
      .terminal-title::before{ content:'●'; color:#238636; font-size:10px; animation:pulse 2s ease-in-out infinite; }
      @keyframes pulse{ 0%,100%{opacity:1;} 50%{opacity:0.4;} }
      .terminal-controls{ display:flex; gap:8px; }
      .terminal-controls button{ background:#161b22; border:1px solid #30363d; color:#7d8590; padding:6px 14px; font-size:12px; border-radius:6px; cursor:pointer; transition:all 0.2s; font-weight:500; }
      .terminal-controls button:hover{ background:#1f2328; border-color:#e6edf3; color:#e6edf3; transform:translateY(-1px); box-shadow:0 4px 8px rgba(230,237,243,0.1); }
      .terminal-controls button.danger{ color:#ff7b72; }
      .terminal-controls button.danger:hover{ border-color:#ff7b72; background:#1a1414; box-shadow:0 4px 8px rgba(255,123,114,0.1); }
      .filter-bar{ padding:12px 20px; background:#0d1117; border-bottom:1px solid #1f2328; display:flex; gap:12px; align-items:center; }
      .filter-label{ font-size:12px; text-transform:uppercase; letter-spacing:1.2px; color:#484f58; font-weight:600; margin-right:8px; }
      .filter-btn{ background:#161b22; border:1px solid #30363d; color:#7d8590; padding:6px 16px; border-radius:6px; font-size:12px; cursor:pointer; transition:all 0.2s; font-weight:500; }
      .filter-btn:hover{ border-color:#58a6ff; color:#58a6ff; background:#1c2128; }
      .filter-btn.active{ background:#1f6feb; color:#ffffff; border-color:#1f6feb; box-shadow:0 0 0 3px rgba(31,111,235,0.12); }
      .terminal-body{ max-height:600px; overflow-y:auto; padding:20px; background:#0a0a0a; font-size:13px; line-height:1.6; }
      .terminal-body::-webkit-scrollbar{ width:10px; }
      .terminal-body::-webkit-scrollbar-track{ background:#0a0a0a; border-left:1px solid #1f2328; }
      .terminal-body::-webkit-scrollbar-thumb{ background:#30363d; border-radius:5px; border:2px solid #0a0a0a; }
      .terminal-body::-webkit-scrollbar-thumb:hover{ background:#484f58; }
      .log-entry{ margin-bottom:20px; padding:16px; background:#0d1117; border:1px solid #1f2328; border-radius:8px; border-left:3px solid #c3e3ff; }
      .log-entry.error{ border-left-color:#da3633; }
      .log-header{ display:flex; justify-content:space-between; align-items:center; margin-bottom:12px; padding-bottom:10px; border-bottom:1px solid #1f2328; }
      .log-timestamp{ font-size:11px; color:#7d8590; font-family:'SF Mono',monospace; }
      .log-status{ padding:4px 10px; border:1px solid; font-size:10px; font-weight:700; text-transform:uppercase; border-radius:4px; letter-spacing:0.5px; }
      .log-status.success{ color:#2ea043; border-color:#2da44e; background:rgba(46,160,67,0.12); }
      .log-status.error{ color:#f85149; border-color:#da3633; background:rgba(248,81,73,0.12); }
      .log-section{ margin:10px 0; }
      .log-section-title{ font-size:11px; color:#58a6ff; margin-bottom:8px; font-weight:700; text-transform:uppercase; letter-spacing:0.8px; }
      .log-content{ background:#010409; padding:12px; border:1px solid #1f2328; border-radius:6px; font-size:12px; line-height:1.7; white-space:pre-wrap; word-break:break-word; color:#e6edf3; }
      .log-content.json{ color:#8b949e; }
      .empty-state{ text-align:center; padding:80px 20px; color:#484f58; font-size:14px; }
      .empty-state::before{ content:'⏳'; display:block; font-size:48px; margin-bottom:16px; opacity:0.5; }
      .stats-bar{ padding:16px 20px; background:#0d1117; border-top:1px solid #1f2328; display:flex; gap:24px; font-size:12px; flex-wrap:wrap; }
      .stat-item{ display:flex; align-items:center; gap:8px; padding:8px 12px; background:#161b22; border-radius:6px; border:1px solid #30363d; }
      .stat-label{ color:#7d8590; font-weight:500; }
      .stat-label::after{ content:':'; margin-left:2px; }
      .stat-value{ font-weight:700; font-family:'SF Mono',monospace; }
      
      /* Help/Markdown Styles */
      .markdown-content{ background: var(--card); border:1px solid var(--border); border-radius: 12px; padding:32px; line-height:1.8; box-shadow: 0 4px 12px rgba(0,0,0,0.3); }
      .markdown-content h1{ font-size:28px; font-weight:700; margin:0 0 24px 0; color:var(--text); border-bottom:2px solid var(--border); padding-bottom:12px; }
      .markdown-content h2{ font-size:22px; font-weight:700; margin:32px 0 16px 0; color:var(--text); }
      .markdown-content h3{ font-size:18px; font-weight:600; margin:24px 0 12px 0; color:var(--text); }
      .markdown-content p{ margin:12px 0; color:var(--text); }
      .markdown-content ul, .markdown-content ol{ margin:12px 0; padding-left:28px; color:var(--text); }
      .markdown-content li{ margin:8px 0; }
      .markdown-content code{ background:#161b22; padding:3px 8px; border-radius:4px; font-family:'JetBrains Mono','Fira Code',monospace; font-size:13px; color:#ff7b72; border:1px solid var(--border); }
      .markdown-content pre{ background:#0d1117; padding:16px; border-radius:8px; overflow-x:auto; margin:16px 0; border:1px solid var(--border); }
      .markdown-content pre code{ background:transparent; padding:0; border:none; color:#e6edf3; }
      .markdown-content blockquote{ border-left:4px solid var(--primary); padding:12px 20px; margin:16px 0; background:#0d1117; color:var(--muted); border-radius:0 8px 8px 0; }
      .markdown-content a{ color:var(--primary); text-decoration:none; font-weight:500; }
      .markdown-content a:hover{ text-decoration:underline; }
      .markdown-content img{ max-width: 100%; height: auto; vertical-align: middle; }
      .markdown-content strong{ color:var(--text); font-weight:700; }
      .markdown-content hr{ border:none; border-top:1px solid var(--border); margin:32px 0; }
      .markdown-content table{ width:100%; border-collapse:collapse; margin:16px 0; }
      .markdown-content th, .markdown-content td{ border:1px solid var(--border); padding:10px 14px; text-align:left; }
      .markdown-content th{ background:#0d1117; font-weight:600; color:var(--text); }
      .markdown-content td{ color:var(--text); }
    </style>
  </head>
  <body>
    <div class="page">
      <div class="brand">
        <img src="icons/weixin-1600.png" alt="Logo" class="brand-logo" />
        <div>
          <div class="brand-title">极速学习</div>
          <div class="brand-sub">没什么，只是热爱学习</div>
        </div>
      </div>

      <!-- Tabs -->
      <div class="tabs">
        <button class="tab active" data-tab="settings">设置</button>
        <button class="tab" data-tab="debug">后台</button>
        <button class="tab" data-tab="help">使用说明</button>
      </div>

      <!-- Settings Tab -->
      <div id="tab-settings" class="tab-content active">
        <div class="card">
          <div class="card-hd"><div class="card-tt">AI 设置</div></div>
          <div class="card-bd">
            <div class="grid">
              <div class="field col-2">
                <label>API 地址（base_url）</label>
                <input id="ai_api_url" type="text" placeholder="https://api.moonshot.cn/v1/chat/completions" />
                <div class="desc">支持 OpenAI 兼容接口格式</div>
              </div>
              <div class="field col-2">
                <label>API 密钥（api_key）</label>
                <input id="ai_api_key" type="text" placeholder="sk-..." />
                <div class="desc">仅保存在本地浏览器</div>
              </div>
              <div class="field">
                <label>模型（model）</label>
                <input id="ai_model" type="text" placeholder="kimi-k2-turbo-preview" />
              </div>
              <div class="field">
                <label>温度（temperature）</label>
                <input id="ai_temperature" type="number" step="0.1" min="0" max="2" />
              </div>
              <div class="field col-2">
                <label>系统提示词（system_prompt）</label>
                <textarea id="ai_system_prompt" placeholder="用于约束回答风格与输出格式"></textarea>
              </div>
              <div class="field">
                <label>扫描间隔秒（answer_interval）</label>
                <input id="answer_interval" type="number" min="1" />
              </div>
              <div class="field">
                <label>自动扫描</label>
                <div class="inline"><input type="checkbox" id="auto_start"/> <span class="hint">页面加载后自动开始扫描</span></div>
              </div>
            </div>
          </div>
          <div class="actions">
            <button id="test_api">测试 API</button>
            <button id="save_simple" class="primary">保存设置</button>
            <span id="msg_simple" class="hint"></span>
          </div>
        </div>
      </div>

      <!-- Debug Tab -->
      <div id="tab-debug" class="tab-content">
        <div class="terminal-container">
          <div class="terminal-header">
            <div class="terminal-title">
              <span>API 监控</span>
            </div>
            <div class="terminal-controls">
              <button id="exportBtn">导出日志</button>
              <button id="clearBtn" class="danger">清空</button>
              <button id="autoRefreshToggle">自动刷新</button>
            </div>
          </div>

          <div class="filter-bar">
            <span class="filter-label">过滤</span>
            <button class="filter-btn active" data-filter="all">全部</button>
            <button class="filter-btn" data-filter="success">成功</button>
            <button class="filter-btn" data-filter="error">失败</button>
          </div>

          <div class="terminal-body" id="logContainer">
            <div class="empty-state">
              等待 API 调用...
            </div>
          </div>

          <div class="stats-bar">
            <div class="stat-item">
              <span class="stat-label">总请求</span>
              <span class="stat-value" id="totalRequests">0</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">成功</span>
              <span class="stat-value" id="successRequests">0</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">失败</span>
              <span class="stat-value" id="errorRequests">0</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">平均耗时</span>
              <span class="stat-value" id="avgTime">0ms</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">运行时间</span>
              <span class="stat-value" id="uptime">0s</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Help Tab -->
      <div id="tab-help" class="tab-content">
        <div class="markdown-content" id="helpContent">
          <p style="text-align:center; color:var(--muted); padding:60px 20px;">加载中...</p>
        </div>
      </div>
    </div>

    <script src="options.js"></script>
  </body>
  </html>
